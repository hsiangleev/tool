<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        input{
            height: 30px;
            line-height: 30px;
        }
        .urpMaxLen-wrap{
            display: inline-block;
            position: relative;
        }
        input::-ms-clear, 
        input::-ms-reveal{
            display: none;
        }
        .urpMaxLen-sub{
            position: absolute;
            right: 0px;
            top: 50%;
            font-size: 12px;
            color: #888;
            transform: translateY(-50%);
        }
    </style>
</head>

<body>
    <input type="text" class="urpMaxLen" urp-max-length="10">
    <input type="text" class="urpMaxLen" urp-max-length="10">
    <script src="jquery.js"></script>
    <script>
        $("input.urpMaxLen").each(function(index, item) {
            var maxLength=$(item).attr("urp-max-length")
            var value=$(item).val();
            var currentLen=value.length;
            $(item).wrap('<div class="urpMaxLen-wrap"></div>').after('<span class="urpMaxLen-sub">'+currentLen+'/'+maxLength+'</span>')
            var subDom=$(item).next(".urpMaxLen-sub");
            var subWidth=subDom.width();
            $(item).css("padding-right",subWidth+5)

            var f=function(self,type) {
                var val=$(self).val();
                if(type==="keydown"){
                    val=val.substring(0,val.length-1)
                }
                var currentLen=val.length;
                if(currentLen>=maxLength){
                    $(self).val(val.substring(0,maxLength))
                    currentLen=maxLength;
                }
                subDom.text(currentLen+"/"+maxLength)
            }

            var writeCn=false;           // 是否是在输入中文
            var keyDownPress=false;     // 防止同时执行keydown和input事件
            $(item).on("compositionstart",function() {
                writeCn=true;
            }).on("compositionend",function() {
                f(this);
                writeCn=false;
            }).on("input", function() {
                if(!writeCn && !keyDownPress) {
                    f(this);
                    keyDownPress=false;
                }
            }).on("keydown",function() {
                // ie9删除不触发input事件
                var keyCode=event.keyCode;
                if(keyCode===8 && !writeCn) {
                    f(this, "keydown");
                    keyDownPress=true;
                }else{
                    keyDownPress=false;
                }
            })
        })
    </script>
</body>

</html>